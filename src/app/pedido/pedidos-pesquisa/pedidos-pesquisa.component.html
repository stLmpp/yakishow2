<div class="page-title">
  <h2>Pesquisar pedidos</h2>
</div>
<mat-expansion-panel class="pesquisa" [expanded]="true" #searchPanel>
  <mat-expansion-panel-header>
    Parâmetros de pesquisa
  </mat-expansion-panel-header>
  <div [formGroup]="form" class="form">
    <mat-form-field>
      <input
        matInput
        [matDatepicker]="dataCriacao"
        placeholder="Criação"
        formControlName="dataCriacao"
      />
      <mat-datepicker-toggle
        [for]="dataCriacao"
        matSuffix
      ></mat-datepicker-toggle>
      <mat-datepicker
        [touchUi]="touchUi$ | async"
        #dataCriacao
        disabled="false"
      ></mat-datepicker>
    </mat-form-field>
    <mat-form-field>
      <input
        matInput
        placeholder="Hora finalizado"
        formControlName="dataFinalizado"
        inputmode="numeric"
        [mask]="maskEnum.horaMinuto"
        [dropSpecialCharacters]="false"
      />
    </mat-form-field>
    <mat-form-field
      class="full-row"
      *ngLet="form.get('cliente') as clienteControl"
    >
      <input
        matInput
        formControlName="cliente"
        placeholder="Cliente"
        [matAutocomplete]="clienteAutocomplete"
      />
      <mat-spinner
        diameter="18"
        matSuffix
        *ngIf="clientesLoading"
      ></mat-spinner>
      <mat-icon
        matSuffix
        (click)="selectCliente(null)"
        *ngIf="clienteControl.disabled"
      >
        clear
      </mat-icon>
      <mat-autocomplete #clienteAutocomplete [autoActiveFirstOption]="true">
        <mat-option
          *ngFor="let cliente of clientes$ | async; trackBy: trackByCliente"
          [value]="cliente.nome"
          (onSelectionChange)="selectCliente(cliente)"
        >
          {{ cliente.celular | mask: maskEnum.celular }} - {{ cliente.nome }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
    <mat-form-field
      class="full-row"
      *ngLet="form.get('produto') as produtoControl"
    >
      <input
        matInput
        placeholder="Produto"
        formControlName="produto"
        [matAutocomplete]="produtoAutocomplete"
      />
      <mat-spinner
        diameter="18"
        matSuffix
        *ngIf="produtosLoading"
      ></mat-spinner>
      <mat-autocomplete #produtoAutocomplete [autoActiveFirstOption]="true">
        <mat-option
          *ngFor="let produto of produtos$ | async; trackBy: trackByProduto"
          [value]="produto.descricao"
          (onSelectionChange)="selectProduto(produto)"
        >
          {{ produto.codigo }} - {{ produto.descricao }}
        </mat-option>
      </mat-autocomplete>
      <mat-icon
        matSuffix
        (click)="selectProduto(null)"
        *ngIf="produtoControl.disabled"
      >
        clear
      </mat-icon>
    </mat-form-field>
  </div>
</mat-expansion-panel>
<button mat-mini-fab floating left routerLink="../">
  <mat-icon>keyboard_arrow_left</mat-icon>
</button>
<button mat-mini-fab floating right (click)="pesquisar()">
  <mat-icon>search</mat-icon>
</button>
{{ pedidos$ | async }}
